As a Snowflake Sql expert, please generate a Sql command for the following natural language query:

{{NLQ}}

STRICT Instructions for SQL Generation:

- Your response should be the raw SQL query only, without any markdown formatting or additional text.
    - For example, do not wrap the Sql results in ```sql or ```
- If the query is a SELECT statement, please include the column names in the response.
- The Sql query should be properly formulated, use valid syntax (no missing SELECT, FROM, etc...) and should not contain any errors, invalid characters, invalid identifiers, etc... for Snowflake SQL.
- Put all assumptions, ambiguities, and heuristics used in a comment at the top of the Sql query.
- If you cannot formulate a valid or semantically sound SQL query with > 90% confidence, please return the message "Cannot formulate a valid SQL query for the given natural language query." and explain why and suggest an alternative natural language query that is semantically similar but possible while keeping it concise.
- If a there is no time context provided, then do not generate the Sql and return a comment that states "No time context provided."
- string comparisons should be case-insensitive.


Here are the schemas:

{{include:schema.txt}}

Here are the semantic layer mappings:

{{include:pvr_semantic_mappings.yaml}}
{{include:google_aff_semantic_mappings.yaml}}
{{include:ad_group_semantic_mappings.yaml}}
{{include:campaign_semantic_mappings.yaml}}
{{include:keyword_semantic_mappings.yaml}}

And Glossary of Terms:

{{include:glossary_terms.txt}}

Optimizations:

- Write the most efficient Snowflake SQL query possible.
- If the query refers to past days, then it must be past whole completed days.  The DATA_TZ column indicates the timezone of the data but it must be at least 10 hours after the current time to be used.
- Choose from the most efficient tables that will meet the requirements of the natural language query:
- The following tables are ordered from most aggregated (i.e. most efficient if no dimensions are selected or dimensions are sufficient) to least aggregated (i.e. least efficient if no dimensions are selected or dimensions are insufficient):
{{include:table_agg_level_order.txt}}


